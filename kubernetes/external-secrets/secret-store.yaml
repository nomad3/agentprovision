---
# SecretStore for prod namespace - connects to GCP Secret Manager
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: gcp-secret-store
  namespace: prod
  labels:
    app.kubernetes.io/name: agentprovision
    app.kubernetes.io/component: secrets
spec:
  provider:
    gcpsm:
      # GCP Project ID where secrets are stored
      projectID: YOUR_GCP_PROJECT
      auth:
        # Use Workload Identity - no explicit credentials needed
        workloadIdentity:
          clusterLocation: YOUR_GCP_REGION
          clusterName: YOUR_GKE_CLUSTER
          clusterProjectID: YOUR_GCP_PROJECT
          serviceAccountRef:
            name: external-secrets-sa
            namespace: prod
---
# SecretStore for database namespace
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: gcp-secret-store
  namespace: database
  labels:
    app.kubernetes.io/name: agentprovision
    app.kubernetes.io/component: secrets
spec:
  provider:
    gcpsm:
      projectID: YOUR_GCP_PROJECT
      auth:
        workloadIdentity:
          clusterLocation: YOUR_GCP_REGION
          clusterName: YOUR_GKE_CLUSTER
          clusterProjectID: YOUR_GCP_PROJECT
          serviceAccountRef:
            name: external-secrets-sa
            namespace: database
