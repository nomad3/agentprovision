# Default values for microservice chart
# This is a YAML-formatted file.

# Service metadata
nameOverride: ""
fullnameOverride: ""

# Container image configuration
image:
  repository: gcr.io/your-project/service
  tag: latest
  pullPolicy: IfNotPresent

imagePullSecrets: []

# Service account configuration
serviceAccount:
  create: true
  annotations: {}
  name: ""
  # Workload Identity annotation for GCP
  # iam.gke.io/gcp-service-account: sa@project.iam.gserviceaccount.com

# Pod configuration
replicaCount: 2

podAnnotations: {}
podLabels: {}

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 1000

securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL

# Container configuration
container:
  port: 8000
  command: []
  args: []

# Resource limits and requests
resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi

# Health probes
livenessProbe:
  enabled: true
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  enabled: true
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 5
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3

startupProbe:
  enabled: false
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 30

# Service configuration
service:
  type: ClusterIP
  port: 80
  targetPort: 8000
  annotations: {}

# Ingress configuration (legacy)
ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts: []
  tls: []

# Gateway API HTTPRoute configuration
httpRoute:
  enabled: false
  parentRefs:
    - name: servicetsunami-gateway
      namespace: gateway-system
  hostnames: []
  rules: []

# ConfigMap configuration
configMap:
  enabled: false
  data: {}

# External Secrets configuration
externalSecret:
  enabled: false
  refreshInterval: 1h
  secretStoreRef:
    name: gcp-secret-store
    kind: SecretStore
  target:
    name: ""
    creationPolicy: Owner
  data: []
  # - secretKey: DATABASE_URL
  #   remoteRef:
  #     key: servicetsunami-database-url

# Environment variables from ConfigMap
envFrom:
  configMapRef: []
  secretRef: []

# Direct environment variables
env: []
# - name: LOG_LEVEL
#   value: "info"

# Horizontal Pod Autoscaler
autoscaling:
  enabled: false
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

# Pod Disruption Budget
podDisruptionBudget:
  enabled: false
  minAvailable: 1
  # maxUnavailable: 1

# Persistent Volume Claims
persistence:
  enabled: false
  storageClass: ""
  accessModes:
    - ReadWriteOnce
  size: 10Gi
  annotations: {}

# Extra volumes
volumes: []
volumeMounts: []

# Temporary directories (emptyDir)
tmpDirs:
  - /tmp

# Extra containers (sidecars)
extraContainers: []
# - name: cloud-sql-proxy
#   image: gcr.io/cloud-sql-connectors/cloud-sql-proxy:2.8.0
#   args:
#     - "--structured-logs"
#     - "--port=5432"
#     - "project:region:instance"

# Init containers
initContainers: []
# - name: wait-for-db
#   image: busybox:1.36
#   command: ['sh', '-c', 'until nc -z db 5432; do sleep 2; done']

# Migration job (pre-install/pre-upgrade hook)
migrationJob:
  enabled: false
  image:
    repository: ""
    tag: ""
  command: []
  args: []
  backoffLimit: 3
  ttlSecondsAfterFinished: 300
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

# Seed job (post-install hook)
seedJob:
  enabled: false
  image:
    repository: ""
    tag: ""
  command: []
  args: []
  backoffLimit: 1
  ttlSecondsAfterFinished: 300

# Node selection
nodeSelector: {}
tolerations: []
affinity: {}

# Topology spread constraints
topologySpreadConstraints: []

# GCP Managed Certificate
managedCertificate:
  enabled: false
  domains: []

# Health check policy for GKE
healthCheckPolicy:
  enabled: false
  config:
    type: HTTP
    httpHealthCheck:
      port: 8000
      requestPath: /health

# Nginx configuration (for frontend)
nginxConfig:
  enabled: false
  config: ""
